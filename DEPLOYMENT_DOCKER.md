# üê≥ Docker Compose (Linux / Windows)

–≠—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç **API (FastAPI)** –∏ **PostgreSQL** –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∞:
- **Linux** (Docker Engine + Docker Compose)
- **Windows** (Docker Desktop + WSL2)

## 1) –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ Docker Compose.
2. –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
   - —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` ‚Üí `.env`
   - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–¥–∞–π—Ç–µ `POSTGRES_PASSWORD` (–Ω–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å)

## 2) –ó–∞–ø—É—Å–∫

–í –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
docker compose up -d --build
```

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
docker compose ps
docker compose logs -f api
```

API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- `http://localhost:8000/docs`

## 3) –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

### Desktop app
–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å API —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- Linux/macOS:
  ```bash
  export CYBER_VIS_API_BASE="http://localhost:8000"
  ```
- Windows (PowerShell):
  ```powershell
  $env:CYBER_VIS_API_BASE = "http://localhost:8000"
  ```

–ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ, –ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ –µ—ë IP/–¥–æ–º–µ–Ω:
`http://<server-ip>:8000` (–∏–ª–∏ `https://<domain>` –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ TLS).

### Web monitor (HTML)
–û–±–Ω–æ–≤–∏—Ç–µ URL –≤ HTML (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç):

```bash
python update_api_urls.py http://localhost:8000
```

–ï—Å–ª–∏ –≤–∞—à —Å–∞–π—Ç –ª–µ–∂–∏—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–∞–ø–∫–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä GitHub Pages), –ø–µ—Ä–µ–¥–∞–π—Ç–µ –ø—É—Ç—å –≤—Ç–æ—Ä—ã–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º:

```bash
python update_api_urls.py https://api.example.com "D:\–î–∏–ø–ª–æ–º__–ù–ê__2026__–≥–æ–¥\–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ\Host\cybattack.ru.github.io"
```

## 4) –î–æ—Å—Ç—É–ø –∫ PostgreSQL

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é PostgreSQL **–Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –Ω–∞—Ä—É–∂—É** (—ç—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ). –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ—Å—å –∏–∑–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

```bash
docker compose exec db psql -U "$POSTGRES_USER" -d "$POSTGRES_DB"
```

–î–∞–Ω–Ω—ã–µ PostgreSQL —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ volume `pgdata`.

## 5) –£–¥–∞–ª—ë–Ω–Ω—ã–π Linux —Å–µ—Ä–≤–µ—Ä (–∑–∞–º–µ—Ç–∫–∏)

- –û—Ç–∫—Ä–æ–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç—É `8000/tcp` –Ω–∞ —Ñ–∞–µ—Ä–≤–æ–ª–µ (–µ—Å–ª–∏ –±–µ–∑ reverse-proxy).
- –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ **HTTPS/WSS** –ª—É—á—à–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å reverse-proxy (Caddy/Nginx) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ä—Ç `443`.

## 6) HTTPS/WSS —á–µ—Ä–µ–∑ Caddy (–Ω—É–∂–Ω–æ –¥–ª—è GitHub Pages)

–ï—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ **HTTPS** (GitHub Pages –≤—Å–µ–≥–¥–∞ HTTPS), —Ç–æ –±—Ä–∞—É–∑–µ—Ä –∑–∞–±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `http://...` –∏ `ws://...`.
–†–µ—à–µ–Ω–∏–µ ‚Äî –ø–æ–¥–Ω—è—Ç—å API –Ω–∞ `https://...` –∏ `wss://...` —á–µ—Ä–µ–∑ Caddy (Let‚Äôs Encrypt):

1. –ü—Ä–∏–≤—è–∂–∏—Ç–µ –¥–æ–º–µ–Ω –∫ IP —Å–µ—Ä–≤–µ—Ä–∞ (A/AAAA –∑–∞–ø–∏—Å—å).
2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç—ã `80` –∏ `443` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
3. –í `.env` –∑–∞–¥–∞–π—Ç–µ `CYBER_VIS_DOMAIN` (–Ω–∞–ø—Ä–∏–º–µ—Ä `api.example.com`).
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker compose -f compose.yaml -f compose.caddy.yaml up -d --build
```
